<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DILG Attendance System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        .slide-in {
            animation: slideIn 0.4s ease-out;
        }
        
        .scale-in {
            animation: scaleIn 0.3s ease-out;
        }
        
        .pulse-loading {
            animation: pulse 1.5s ease-in-out infinite;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        }
        
        .gradient-button {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .gradient-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(220, 38, 38, 0.4);
        }
        
        .gradient-button:active {
            transform: translateY(0);
        }
        
        .gradient-yellow {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .gradient-yellow:hover {
            box-shadow: 0 10px 20px rgba(245, 158, 11, 0.4);
        }
        
        .table-row-hover {
            transition: all 0.2s ease;
        }
        
        .table-row-hover:hover {
            transform: scale(1.01);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .modal-backdrop {
            backdrop-filter: blur(5px);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        
        .stat-card {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card-yellow {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        /* SweetAlert2 Custom Styles */
        .swal2-popup {
            border-radius: 1rem !important;
            padding: 2rem !important;
        }
        
        .swal2-title {
            font-size: 1.5rem !important;
            font-weight: 700 !important;
        }
        
        .swal2-html-container {
            font-size: 1rem !important;
        }
        
        .swal2-confirm {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%) !important;
            border-radius: 0.5rem !important;
            padding: 0.75rem 2rem !important;
            font-weight: 600 !important;
        }
        
        .swal2-cancel {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%) !important;
            border-radius: 0.5rem !important;
            padding: 0.75rem 2rem !important;
            font-weight: 600 !important;
        }
        
        .swal2-icon {
            border-width: 3px !important;
        }
    </style>
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, query, where, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyA3Y9xgK6AhrjP2OFLleLkEdIVYmaic9Hs",
  authDomain: "attendancesystem-ddcea.firebaseapp.com",
  projectId: "attendancesystem-ddcea",
  storageBucket: "attendancesystem-ddcea.firebasestorage.app",
  messagingSenderId: "785581742832",
  appId: "1:785581742832:web:ee45799f829b0ba61ec035",
  measurementId: "G-2VS572MJQW"
};

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Global state
        let currentSort = { column: 'timestamp', direction: 'desc' };
        let currentUser = null;

        // SweetAlert2 Configuration
        const Toast = Swal.mixin({
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 3000,
            timerProgressBar: true,
            didOpen: (toast) => {
                toast.addEventListener('mouseenter', Swal.stopTimer)
                toast.addEventListener('mouseleave', Swal.resumeTimer)
            }
        });

        // Check authentication state
        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
                document.getElementById('loginSection').classList.add('hidden');
                document.getElementById('attendanceSection').classList.remove('hidden');
                document.getElementById('userEmail').textContent = user.email;
                loadAttendanceRecords();
            } else {
                currentUser = null;
                document.getElementById('loginSection').classList.remove('hidden');
                document.getElementById('attendanceSection').classList.add('hidden');
            }
        });

        // Login function
        window.handleLogin = async (event) => {
            event.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const loginBtn = event.target.querySelector('button[type="submit"]');
            
            loginBtn.disabled = true;
            loginBtn.innerHTML = '<span class="pulse-loading">Logging in...</span>';

            try {
                await signInWithEmailAndPassword(auth, email, password);
                await Swal.fire({
                    icon: 'success',
                    title: 'Welcome to DILG!',
                    text: 'Login successful',
                    timer: 2000,
                    timerProgressBar: true,
                    showConfirmButton: false,
                    willClose: () => {
                        // Ensure proper cleanup
                    }
                });
            } catch (error) {
                loginBtn.disabled = false;
                loginBtn.textContent = 'Login';
                await Swal.fire({
                    icon: 'error',
                    title: 'Login Failed',
                    text: error.message,
                    confirmButtonText: 'Try Again',
                    confirmButtonColor: '#dc2626'
                });
            }
        };

        // Logout function
        window.handleLogout = async () => {
            const result = await Swal.fire({
                title: 'Logout Confirmation',
                text: "Are you sure you want to logout?",
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#dc2626',
                cancelButtonColor: '#6b7280',
                confirmButtonText: 'Yes, Logout',
                cancelButtonText: 'Cancel'
            });

            if (result.isConfirmed) {
                try {
                    await signOut(auth);
                    await Swal.fire({
                        icon: 'success',
                        title: 'Logged Out',
                        text: 'You have been logged out successfully',
                        timer: 2000,
                        timerProgressBar: true,
                        showConfirmButton: false
                    });
                } catch (error) {
                    await Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: error.message,
                        confirmButtonColor: '#dc2626'
                    });
                }
            }
        };

        // Open modal
        window.openModal = () => {
            const modal = document.getElementById('attendanceModal');
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.querySelector('.glass-effect').classList.add('scale-in');
            }, 10);
        };

        // Close modal
        window.closeModal = () => {
            document.getElementById('attendanceModal').classList.add('hidden');
            document.getElementById('attendanceForm').reset();
        };

        // Add attendance
        window.addAttendance = async (event) => {
            event.preventDefault();
            
            if (!currentUser) {
                await Swal.fire({
                    icon: 'error',
                    title: 'Authentication Error',
                    text: 'You must be logged in to add attendance',
                    confirmButtonColor: '#dc2626'
                });
                return;
            }
            
            const name = document.getElementById('name').value;
            const timeIn = document.getElementById('timeIn').value;
            const timeOut = document.getElementById('timeOut').value;
            const amPm = document.getElementById('amPm').value;
            const submitBtn = event.target.querySelector('button[type="submit"]');
            
            const originalButtonHTML = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="pulse-loading">Adding...</span>';

            try {
                await addDoc(collection(db, 'attendance'), {
                    name: name,
                    timeIn: timeIn,
                    timeOut: timeOut,
                    amPm: amPm,
                    uid: currentUser.uid,
                    timestamp: serverTimestamp(),
                    createdAt: new Date().toISOString()
                });

                await Swal.fire({
                    icon: 'success',
                    title: 'Record Added!',
                    text: 'Attendance record has been added successfully',
                    timer: 2000,
                    timerProgressBar: true,
                    showConfirmButton: false
                });

                closeModal();
                loadAttendanceRecords();
            } catch (error) {
                await Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Failed to add record: ' + error.message,
                    confirmButtonColor: '#dc2626'
                });
            } finally {
                // Always reset the button state
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalButtonHTML;
            }
        };

        // Load attendance records
        window.loadAttendanceRecords = async () => {
            if (!currentUser) return;

            const tbody = document.getElementById('attendanceTableBody');
            tbody.innerHTML = `
                <tr>
                    <td colspan="5" class="px-6 py-8 text-center">
                        <div class="pulse-loading text-gray-500">Loading records...</div>
                    </td>
                </tr>
            `;

            try {
                const q = query(
                    collection(db, 'attendance'),
                    where('uid', '==', currentUser.uid)
                );
                const querySnapshot = await getDocs(q);
                const records = [];
                
                querySnapshot.forEach((doc) => {
                    records.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });

                displayRecords(records);
                updateStats(records);
            } catch (error) {
                console.error('Error loading records:', error);
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" class="px-6 py-4 text-center text-red-500">
                            Error loading records: ${error.message}
                        </td>
                    </tr>
                `;
            }
        };

        // Update statistics
        window.updateStats = (records) => {
            const totalRecords = records.length;
            const today = new Date().toDateString();
            const todayRecords = records.filter(r => {
                const recordDate = new Date(r.createdAt).toDateString();
                return recordDate === today;
            }).length;
            
            const amRecords = records.filter(r => r.amPm === 'AM').length;
            const pmRecords = records.filter(r => r.amPm === 'PM').length;

            document.getElementById('totalRecords').textContent = totalRecords;
            document.getElementById('todayRecords').textContent = todayRecords;
            document.getElementById('amRecords').textContent = amRecords;
            document.getElementById('pmRecords').textContent = pmRecords;
        };

        // Display records with sorting
        window.displayRecords = (records) => {
            // Sort records
            records.sort((a, b) => {
                let aVal = a[currentSort.column];
                let bVal = b[currentSort.column];

                if (currentSort.column === 'timeIn' || currentSort.column === 'timeOut') {
                    aVal = aVal || '';
                    bVal = bVal || '';
                } else if (currentSort.column === 'timestamp') {
                    aVal = a.createdAt || '';
                    bVal = b.createdAt || '';
                }

                if (currentSort.direction === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });

            const tbody = document.getElementById('attendanceTableBody');
            tbody.innerHTML = '';

            if (records.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" class="px-6 py-12 text-center">
                            <div class="fade-in">
                                <svg class="mx-auto h-16 w-16 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                                <p class="mt-4 text-gray-600 font-semibold text-lg">No attendance records found</p>
                                <p class="text-gray-500 text-sm mt-2">Click "Add New Attendance" to create your first record</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            records.forEach((record, index) => {
                const row = document.createElement('tr');
                row.className = 'border-b table-row-hover slide-in';
                row.style.animationDelay = `${index * 0.05}s`;
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <div class="flex items-center">
                            <div class="h-12 w-12 flex-shrink-0 gradient-bg rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg">
                                ${record.name.charAt(0).toUpperCase()}
                            </div>
                            <div class="ml-4">
                                <div class="font-semibold text-gray-900 text-base">${record.name}</div>
                                <div class="text-xs text-gray-500 mt-1 flex items-center">
                                    <svg class="w-3 h-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                    ${new Date(record.createdAt).toLocaleDateString('en-PH', { year: 'numeric', month: 'long', day: 'numeric' })}
                                </div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <span class="inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-semibold bg-green-100 text-green-800">
                            <svg class="w-4 h-4 mr-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            ${record.timeIn || '-'}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <span class="inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-semibold bg-red-100 text-red-800">
                            <svg class="w-4 h-4 mr-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            ${record.timeOut || '-'}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <span class="inline-flex items-center px-3 py-1.5 rounded-lg text-xs font-bold ${record.amPm === 'AM' ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'}">
                            ${record.amPm === 'AM' ? '‚òÄÔ∏è' : 'üåô'} ${record.amPm}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <button onclick="deleteRecord('${record.id}')" 
                                class="inline-flex items-center bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white px-4 py-2 rounded-lg transition duration-200 transform hover:scale-105 font-semibold shadow-md">
                            <svg class="w-4 h-4 mr-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                            </svg>
                            Delete
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        };

        // Delete record
        window.deleteRecord = async (id) => {
            const result = await Swal.fire({
                title: 'Delete Record?',
                text: "This action cannot be undone!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#dc2626',
                cancelButtonColor: '#6b7280',
                confirmButtonText: 'Yes, Delete',
                cancelButtonText: 'Cancel'
            });

            if (result.isConfirmed) {
                try {
                    await deleteDoc(doc(db, 'attendance', id));
                    await Swal.fire({
                        icon: 'success',
                        title: 'Deleted!',
                        text: 'Record has been removed successfully',
                        timer: 2000,
                        timerProgressBar: true,
                        showConfirmButton: false
                    });
                    loadAttendanceRecords();
                } catch (error) {
                    await Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: 'Failed to delete: ' + error.message,
                        confirmButtonColor: '#dc2626'
                    });
                }
            }
        };

        // Sort table
        window.sortTable = (column) => {
            if (currentSort.column === column) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.column = column;
                currentSort.direction = 'asc';
            }

            // Update sort indicators
            document.querySelectorAll('.sort-indicator').forEach(el => {
                el.innerHTML = `
                    <svg class="w-4 h-4 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" />
                    </svg>
                `;
                el.classList.remove('text-yellow-300');
            });

            const indicator = document.getElementById(`sort-${column}`);
            if (currentSort.direction === 'asc') {
                indicator.innerHTML = `
                    <svg class="w-4 h-4 inline-block text-yellow-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />
                    </svg>
                `;
            } else {
                indicator.innerHTML = `
                    <svg class="w-4 h-4 inline-block text-yellow-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                `;
            }

            loadAttendanceRecords();
        };

        // Set current time
        window.setCurrentTime = (inputId) => {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            document.getElementById(inputId).value = `${hours}:${minutes}`;
            
            // Auto-set AM/PM based on time
            const hour = now.getHours();
            document.getElementById('amPm').value = hour < 12 ? 'AM' : 'PM';
        };

        // Close modal on outside click
        window.onclick = (event) => {
            const modal = document.getElementById('attendanceModal');
            if (event.target === modal) {
                closeModal();
            }
        };
    </script>
</head>
<body class="bg-gray-50 min-h-screen">
    
    <!-- Login Section -->
    <div id="loginSection" class="hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="glass-effect p-8 rounded-2xl shadow-2xl w-full max-w-md fade-in border-t-4 border-red-600">
                <div class="text-center mb-8">
                    <div class="inline-block gradient-bg p-4 rounded-full mb-4 shadow-lg">
                        <svg class="w-16 h-16 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                    </div>
                    <h1 class="text-3xl font-bold text-gray-800 mb-2">
                        DILG Attendance System
                    </h1>
                    <p class="text-sm text-gray-600 font-medium">Department of the Interior and Local Government</p>
                    <p class="text-gray-500 mt-3">Please login to continue</p>
                </div>
                <form onsubmit="handleLogin(event)">
                    <div class="mb-4">
                        <label class="block text-gray-700 font-semibold mb-2 flex items-center">
                            <svg class="w-5 h-5 mr-2 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207" />
                            </svg>
                            Email Address
                        </label>
                        <input type="email" id="email" required
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition duration-200"
                               placeholder="your.email@dilg.gov.ph">
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 font-semibold mb-2 flex items-center">
                            <svg class="w-5 h-5 mr-2 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                            </svg>
                            Password
                        </label>
                        <input type="password" id="password" required
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition duration-200"
                               placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    <button type="submit"
                            class="w-full gradient-button text-white font-bold py-3 px-4 rounded-xl shadow-lg flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
                        </svg>
                        Login to DILG System
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Attendance Section -->
    <div id="attendanceSection" class="hidden">
        <!-- Header -->
        <div class="gradient-bg shadow-lg">
            <div class="container mx-auto px-4 py-6">
                <div class="flex justify-between items-center flex-wrap gap-4">
                    <div class="fade-in">
                        <h1 class="text-2xl md:text-3xl font-bold text-white flex items-center gap-3">
                            <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            DILG Attendance System
                        </h1>
                        <p class="text-red-100 mt-2 text-sm md:text-base flex items-center">
                            <svg class="w-4 h-4 mr-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                            <span id="userEmail" class="font-semibold"></span>
                        </p>
                    </div>
                    <button onclick="handleLogout()"
                            class="bg-white hover:bg-gray-100 text-red-600 px-6 py-3 rounded-xl transition duration-200 transform hover:scale-105 font-bold shadow-lg flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                        </svg>
                        Logout
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="container mx-auto px-4 py-8">
            
            <!-- Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="stat-card rounded-2xl p-6 text-white shadow-lg fade-in">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm opacity-90 font-medium">Total Records</p>
                            <p id="totalRecords" class="text-4xl font-bold mt-2">0</p>
                        </div>
                        <svg class="w-12 h-12 opacity-80" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                        </svg>
                    </div>
                </div>
                
                <div class="stat-card stat-card-yellow rounded-2xl p-6 text-white shadow-lg fade-in" style="animation-delay: 0.1s">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm opacity-90 font-medium">Today's Records</p>
                            <p id="todayRecords" class="text-4xl font-bold mt-2">0</p>
                        </div>
                        <svg class="w-12 h-12 opacity-80" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                    </div>
                </div>
                
                <div class="stat-card stat-card-yellow rounded-2xl p-6 text-white shadow-lg fade-in" style="animation-delay: 0.2s">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm opacity-90 font-medium">AM Records</p>
                            <p id="amRecords" class="text-4xl font-bold mt-2">0</p>
                        </div>
                        <svg class="w-12 h-12 opacity-80" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg>
                    </div>
                </div>
                
                <div class="stat-card rounded-2xl p-6 text-white shadow-lg fade-in" style="animation-delay: 0.3s">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm opacity-90 font-medium">PM Records</p>
                            <p id="pmRecords" class="text-4xl font-bold mt-2">0</p>
                        </div>
                        <svg class="w-12 h-12 opacity-80" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Add Attendance Button -->
            <div class="mb-6 fade-in" style="animation-delay: 0.4s">
                <button onclick="openModal()"
                        class="gradient-button text-white font-bold px-8 py-4 rounded-xl shadow-lg text-base flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    Add New Attendance
                </button>
            </div>

            <!-- Attendance Table -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden fade-in border-t-4 border-red-600" style="animation-delay: 0.5s">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="gradient-bg text-white">
                            <tr>
                                <th class="px-6 py-4 text-left cursor-pointer hover:bg-red-700 transition duration-200" onclick="sortTable('name')">
                                    <div class="flex items-center gap-2 font-bold">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                        </svg>
                                        Name 
                                        <span id="sort-name" class="sort-indicator">
                                            <svg class="w-4 h-4 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" />
                                            </svg>
                                        </span>
                                    </div>
                                </th>
                                <th class="px-6 py-4 text-left cursor-pointer hover:bg-red-700 transition duration-200" onclick="sortTable('timeIn')">
                                    <div class="flex items-center gap-2 font-bold">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                        Time In 
                                        <span id="sort-timeIn" class="sort-indicator">
                                            <svg class="w-4 h-4 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" />
                                            </svg>
                                        </span>
                                    </div>
                                </th>
                                <th class="px-6 py-4 text-left cursor-pointer hover:bg-red-700 transition duration-200" onclick="sortTable('timeOut')">
                                    <div class="flex items-center gap-2 font-bold">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                        Time Out 
                                        <span id="sort-timeOut" class="sort-indicator">
                                            <svg class="w-4 h-4 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" />
                                            </svg>
                                        </span>
                                    </div>
                                </th>
                                <th class="px-6 py-4 text-left cursor-pointer hover:bg-red-700 transition duration-200" onclick="sortTable('amPm')">
                                    <div class="flex items-center gap-2 font-bold">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                                        </svg>
                                        Period 
                                        <span id="sort-amPm" class="sort-indicator">
                                            <svg class="w-4 h-4 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" />
                                            </svg>
                                        </span>
                                    </div>
                                </th>
                                <th class="px-6 py-4 text-left font-bold">
                                    <div class="flex items-center gap-2">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                        </svg>
                                        Actions
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="attendanceTableBody">
                            <tr>
                                <td colspan="5" class="px-6 py-8 text-center">
                                    <div class="pulse-loading text-gray-500">Loading...</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Attendance Modal -->
    <div id="attendanceModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal-backdrop flex items-center justify-center z-50 p-4">
        <div class="glass-effect rounded-2xl shadow-2xl w-full max-w-md p-8 border-t-4 border-red-600">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                    <svg class="w-7 h-7 mr-2 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    Add Attendance
                </h2>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 transition duration-200 hover:rotate-90 transform">
                    <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <form id="attendanceForm" onsubmit="addAttendance(event)">
                <div class="mb-5">
                    <label class="block text-gray-700 font-semibold mb-2 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                        Full Name
                    </label>
                    <input type="text" id="name" required
                           class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition duration-200"
                           placeholder="Enter full name">
                </div>

                <div class="mb-5">
                    <label class="block text-gray-700 font-semibold mb-2 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        Time In
                    </label>
                    <div class="flex gap-2">
                        <input type="time" id="timeIn" required
                               class="flex-1 px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition duration-200">
                        <button type="button" onclick="setCurrentTime('timeIn')"
                                class="gradient-yellow text-white px-6 py-3 rounded-xl transition duration-200 transform hover:scale-105 font-bold shadow-md">
                            Now
                        </button>
                    </div>
                </div>

                <div class="mb-5">
                    <label class="block text-gray-700 font-semibold mb-2 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        Time Out
                    </label>
                    <div class="flex gap-2">
                        <input type="time" id="timeOut" required
                               class="flex-1 px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition duration-200">
                        <button type="button" onclick="setCurrentTime('timeOut')"
                                class="gradient-yellow text-white px-6 py-3 rounded-xl transition duration-200 transform hover:scale-105 font-bold shadow-md">
                            Now
                        </button>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-gray-700 font-semibold mb-2 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg>
                        Period (AM/PM)
                    </label>
                    <select id="amPm" required
                            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition duration-200">
                        <option value="AM">‚òÄÔ∏è Morning (AM)</option>
                        <option value="PM">üåô Afternoon (PM)</option>
                    </select>
                </div>

                <div class="flex gap-3">
                    <button type="submit"
                            class="flex-1 gradient-button text-white font-bold py-3 px-4 rounded-xl shadow-lg flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        Add Record
                    </button>
                    <button type="button" onclick="closeModal()"
                            class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl transition duration-200 shadow-lg flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

</body>
</html>